<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <AssemblyName>Calamari.Azure</AssemblyName>
        <TreatWarningsAsErrors>true</TreatWarningsAsErrors>
        <IsPackable>true</IsPackable>
        <OutputType>Exe</OutputType>
        <Authors>Octopus Deploy</Authors>
        <Copyright>Octopus Deploy Pty Ltd</Copyright>
        <RuntimeIdentifiers>win-x64;linux-x64;osx-x64;linux-arm;linux-arm64</RuntimeIdentifiers>
        <LangVersion>8.0</LangVersion>
        <TargetFrameworks>net462;net6.0</TargetFrameworks>

        <DefineConstants Condition="'$(RuntimeIdentifier)' == 'win-x64'">$(DefineConstants);WIN_X64</DefineConstants>
    </PropertyGroup>
    
    <ItemGroup>
        <PackageReference Include="Azure.Identity" Version="1.13.1"/>
        <PackageReference Include="Azure.ResourceManager" Version="1.11.0"/>
        <PackageReference Include="Azure.ResourceManager.AppService" Version="1.0.2"/>
        <PackageReference Include="Azure.ResourceManager.ResourceGraph" Version="1.0.1"/>
        <PackageReference Include="Azure.ResourceManager.Resources" Version="1.7.0"/>
        <PackageReference Include="Microsoft.AspNetCore.WebUtilities" Version="2.2.0"/>
        <PackageReference Include="Microsoft.DotNet.Analyzers.Compatibility" Version="0.2.12-alpha">
            <PrivateAssets>all</PrivateAssets>
            <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
        </PackageReference>
        <PackageReference Include="Newtonsoft.Json" Version="13.0.3"/>
        <PackageReference Include="Polly" Version="8.3.1"/>
        <PackageReference Include="SharpCompress" Version="0.37.2"/>
        <PackageReference Include="System.Linq.Async" Version="6.0.1"/>
        <PackageReference Include="System.Text.Json" Version="8.0.5"/>
    </ItemGroup>
    <ItemGroup Condition="'$(TargetFramework)' == 'net6.0'">
        <PackageReference Include="Octopus.Data">
            <Version>6.0.0</Version>
        </PackageReference>
        <PackageReference Include="System.IO.FileSystem.AccessControl" Version="4.7.0" />
        <PackageReference Include="System.Security.Principal.Windows" Version="4.7.0" />
    </ItemGroup>

    <ItemGroup>
        <!-- IMPORTANT NOTE
        The version of this NuGet package is important. 
        As the SDK makes native COM calls to the Service Fabric Runtime, if there are any divergence between this package version
        and the versions of the installed Runtime & SDK, you may receive issues.
        If this package version is updated, the TeamCity build steps will need updating to install the matching versions.
        The download URL's for the runtime & SDK that match the current version here are:
        Runtime: https://download.microsoft.com/download/b/8/a/b8a2fb98-0ec1-41e5-be98-9d8b5abf7856/MicrosoftServiceFabric.10.1.2338.9590.exe
        SDK: https://download.microsoft.com/download/b/8/a/b8a2fb98-0ec1-41e5-be98-9d8b5abf7856/MicrosoftServiceFabricSDK.7.1.2338.msi
        -->
        <PackageReference Include="Microsoft.ServiceFabric" Version="10.1.2338"/>
    </ItemGroup>

    <ItemGroup>
        <ProjectReference Include="..\Calamari.Scripting\Calamari.Scripting.csproj" />
        <ProjectReference Include="..\Calamari.CloudAccounts\Calamari.CloudAccounts.csproj"/>
        <ProjectReference Include="..\Calamari.Common\Calamari.Common.csproj"/>
    </ItemGroup>

    <ItemGroup>
        <EmbeddedResource Include="ServiceFabric\Scripts\*"/>
        <EmbeddedResource Include="Scripts\Scripts\*"/>
    </ItemGroup>
</Project>
